<!doctype html>
<html lang="en">
  <head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
	<link rel="stylesheet" href="css/ol.css" type="text/css">
	<link rel="stylesheet" href="css/unav.css" type="text/css">
	<style>
	  .map {
		height: 400px;
		width: 100%;
	  }
	</style>
	<script src="js/jquery.min.js" type="text/javascript"></script>
	<script src="js/ol.js" type="text/javascript"></script>
	<title>uNav for Ubuntu Phone</title>
  </head>
  <body>
	<div id="map" class="map"></div>
	<script type="text/javascript">
	  var map = new ol.Map({
		target: 'map',
		layers: [
		  new ol.layer.Tile({
			source: new ol.source.MapQuest({layer: 'osm'})
		  })
		],
		view: new ol.View({
		center: ol.proj.transform([4.666389, 50.009167], 'EPSG:4326', 'EPSG:3857'),
		zoom: 12,
		minZoom: 1,
		maxZoom: 22
		})
	  });
		pos = new ol.Overlay({
		element: $('<img id="marker_pos" src="img/pos.png">')
			.css({marginTop: '-40px', marginLeft: '-12px', cursor: 'pointer'})
		});
		map.addOverlay(pos);
	</script>
	<div id="unav">
		<p>
			<img src="img/logo.png" id="logo">
			<span id="brand"><a href="https://uappexplorer.com/app/navigator.costales">uNav</a> for <a href="http://www.ubuntu.com/phone/devices">Ubuntu Phone</a></span>
		</p>
		<p id="coords">
			<span class="coord" id="lat"></span>
			<span class="coord" id="lon"></span>
		</p>
	</div>
	<script>
		function getURLParameter(name) {
		  return decodeURIComponent((new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(location.search)||[,""])[1].replace(/\+/g, '%20'))||null
		}
		if (getURLParameter('lat') !== null && getURLParameter('lon') !== null) {
			$('#lat').html("Lat: " + getURLParameter('lat'));
			$('#lon').html("Lon: " + getURLParameter('lon'));
			pos.setPosition(ol.proj.transform([parseFloat(getURLParameter('lon')), parseFloat(getURLParameter('lat'))], 'EPSG:4326', 'EPSG:3857'));
			map.getView().setCenter(ol.proj.transform([parseFloat(getURLParameter('lon')), parseFloat(getURLParameter('lat'))], 'EPSG:4326', 'EPSG:3857'));
		}
		else {
			map.getView().setZoom(4);
		}
	</script>
  </body>
</html>
